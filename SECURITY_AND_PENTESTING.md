# Security Improvements & Pentesting Guide

## 1. Security Improvements Implemented
We have secured the backend application (`Vendor_panel/backend`) with the following measures:

### Critical Fixes
- **Removed Password Logging**: The application was previously logging plain-text passwords during login attempts. This has been removed.
- **Strict CORS**: Cross-Origin Resource Sharing is now restricted to your frontend domain and localhost, preventing unauthorized websites from interacting with your API.

### New Security Layers
- **Helmet**: Added `helmet` middleware to set secure HTTP headers (protects against XSS, Clickjacking, MIME sniffing).
- **Rate Limiting**: Added `express-rate-limit` to limit repeated requests from the same IP (protects against Brute Force and DoS attacks).
  - Limit: 100 requests per 15 minutes.
- **HPP**: Added `hpp` (HTTP Parameter Pollution) middleware to protect against parameter pollution attacks.

---

## 2. Postman Pentesting Guide (Live Server)

Use these steps to test your **Live Backend** at `https://vendor-api.jewellersparadise.com`.

### Prerequisites
- **Base URL**: `https://vendor-api.jewellersparadise.com`
- **Tool**: [Download Postman](https://www.postman.com/downloads/)

### Step 1: Check Connection (Health Check)
*Goal: Ensure the API is online.*

1.  Open Postman.
2.  Set Method to **GET**.
3.  Enter URL: `https://vendor-api.jewellersparadise.com/api/health`
4.  Click **Send**.
5.  **Expected**: Status `200 OK` and a JSON response `{"status": "OK", ...}`.

### Step 2: SQL Injection Test (Login Attack)
*Goal: Attempt to trick the database into logging you in without a valid password.*

1.  Set Method to **POST**.
2.  Enter URL: `https://vendor-api.jewellersparadise.com/api/auth/login`
3.  Click **Body** -> **raw** -> Select **JSON**.
4.  Paste this "Attack" payload:
    ```json
    {
      "email": "' OR '1'='1 --",
      "password": "anything"
    }
    ```
5.  Click **Send**.
6.  **Expected Result**: Status `404 Not Found` or `401 Unauthorized`.
    *   **SAFE**: Response says "This email is not registered" or "Incorrect password".
    *   **VULNERABLE**: If you get `200 OK` and a `token`.

### Step 3: Authorization Bypass Test
*Goal: Try to steal user data without logging in.*

1.  Set Method to **GET**.
2.  Enter URL: `https://vendor-api.jewellersparadise.com/api/protected/profile`
3.  **Important**: Go to the **Headers** tab and ensure there is **NO** "Authorization" header.
4.  Click **Send**.
5.  **Expected Result**: Status `401 Unauthorized` or `403 Forbidden`.
    *   **SAFE**: Response `{"message": "No token provided"}`.
    *   **VULNERABLE**: If you see JSON with `email`, `phone`, `ownerName`, etc.

### Step 4: Rate Limiting Test (DoS Attack Simulation)
*Goal: Spam the server to see if it blocks you.*

1.  Set Method to **GET**.
2.  Enter URL: `https://vendor-api.jewellersparadise.com/api/health`
3.  Click **Send** repeatedly and very fast (click 20-30 times in 10 seconds, or use Postman Runner).
4.  *Note: The limit is 100 requests / 15 mins.*
5.  **Expected Result**: Eventually, the status changes from `200 OK` to `429 Too Many Requests`.
    *   **SAFE**: Response `Too many requests, please try again later.`

### Step 5: XSS (Script Injection) Test
*Goal: Try to save a malicious script into the database.*

1.  **First, Login Normally**:
    *   POST to `/api/auth/login` with your **real** email/password.
    *   Copy the `token` from the response.
2.  **Create a New Request**:
    *   Method: **POST**
    *   URL: `https://vendor-api.jewellersparadise.com/api/protected/offers`
3.  **Add Auth**:
    *   Go to **Headers**.
    *   Key: `Authorization`
    *   Value: `Bearer COPY_YOUR_TOKEN_HERE` (include user "Bearer " space).
4.  **Add Body**:
    *   Select **Body** -> **form-data**.
    *   Key: `title` -> Value: `<script>alert('HACKED')</script>`
    *   Key: `poster` -> (Select any dummy image file)
    *   Key: `description` -> Value: `Test`
    *   ...add other required fields (startDate, etc).
5.  Click **Send**.
6.  **Verify**:
    *   Go to your **Frontend Website**.
    *   Look at the new offer.
    *   **SAFE**: You see the text `<script>...` written out.
    *   **VULNERABLE**: A popup alert says "HACKED".

---

## 3. Manual / Browser Checks

### URL Tampering
1.  Login to your dashboard.
2.  If you see a URL like `/vendor/edit/55`, change it to `/vendor/edit/56`.
3.  **Expected**: You should see "Access Denied" or "Not Found". You should typically not be able to edit someone else's data.

### File Uploads
1.  Try to upload a `.exe` file as your Shop Logo or Offer Image.
2.  **Expected**: The upload should fail.
